SEL
    CASE
        WHEN Tenure_Days < 180   THEN 'TEN_NEW_0_6M'
        WHEN Tenure_Days < 1095  THEN 'TEN_MID_6_36M'
        ELSE 'TEN_LOYAL_36M_PLUS'
    END AS Tenure_Band,
    COUNT(*) AS Num_of_Subs
FROM vdb.Etisalat_active_base
WHERE Running_Date = DATE - 1
  AND (
        Rate_Plan_Product_Id IN (1616,1196,1441,1879,1880,1881,1882,1878)
        OR Rate_Plan_Group IN ('ISP','ISP Corporate','FIXED')
      )
GROUP BY 1
ORDER BY 1;
