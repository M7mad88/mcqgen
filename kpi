this query is inside my script when i run it on Dbeaver trino on analytics_dev schema the out is like below in the last line.

WITH combined_data AS (
    SELECT 
        subscription_id,
        app_name,
        Lower(app_category) AS app_category,
        cast(sum(mbs) AS varchar) total_mbs,
        cast(sum(no_of_sessions) AS INT) total_sessions,
        COUNT(*) AS access_days,
        'app' AS type
    FROM hive.analytics_prod.online_interest_protocols_daily
    WHERE day BETWEEN '2025-10-23' AND '2025-10-25'
    GROUP BY subscription_id, app_name, app_category

    UNION ALL 
    SELECT 
        subscription_id,
        app_name,
        Lower(app_category) AS app_category,
        '0' AS total_mbs,
        sum(no_of_sessions) AS total_sessions,
        COUNT(*) AS access_days,
        'url' AS type
    FROM hive.analytics_prod.online_interest_urls_daily 
    WHERE day BETWEEN '2025-10-23' AND '2025-10-25'
    GROUP BY subscription_id, app_name, app_category

    UNION ALL 
    SELECT 
        subscription_id,
        app_name,
        Lower(app_category) AS app_category,
        '0' AS total_mbs,
        sum(no_of_sessions) AS total_sessions,
        COUNT(*) AS access_days,
        'sms' AS type 
    FROM hive.analytics_prod.online_interest_sms_daily 
    WHERE day BETWEEN '2025-10-23' AND '2025-10-25'
    GROUP BY subscription_id, app_name, app_category

    UNION ALL 
    SELECT 
        subscription_id,
        app_name,
        Lower(app_category) AS app_category,
        '0' AS total_mbs,
        sum(no_of_sessions) AS total_sessions,
        COUNT(*) AS access_days,
        'og' AS type
    FROM hive.analytics_prod.online_interest_og_calls_daily
    WHERE day BETWEEN '2025-10-23' AND '2025-10-25'
    GROUP BY subscription_id, app_name, app_category
),
category_counts AS (
    SELECT 
        app_category,
        count(*) AS interaction_count,
        count(distinct subscription_id) AS sub_count,
        Max(access_days) AS max_access_days,
        Cast(Sum(CASE WHEN TYPE = 'app' THEN Cast(total_mbs AS DECIMAL(38,9)) ELSE 0 END) AS DECIMAL(38,9)) AS app_mbs
    FROM combined_data
    GROUP BY app_category
)
SELECT 
    (SELECT count(distinct subscription_id) FROM combined_data) AS sub_id_counts,
    (SELECT count(*) FROM combined_data) AS total_interactions,
    -- Online Shopping
    SUM(CASE WHEN app_category = 'online shopping' THEN interaction_count ELSE 0 END) AS online_shopping_counts,
    SUM(CASE WHEN app_category = 'online shopping' THEN sub_count ELSE 0 END) AS online_shopping_sub_counts,
    MAX(CASE WHEN app_category = 'online shopping' THEN max_access_days ELSE 0 END) AS online_shopping_access_days,
    SUM(CASE WHEN app_category = 'online shopping' THEN app_mbs ELSE 0 END) AS online_shopping_app_mbs,
    -- Travel
    SUM(CASE WHEN app_category = 'travel' THEN interaction_count ELSE 0 END) AS travel_flag_counts,
    SUM(CASE WHEN app_category = 'travel' THEN sub_count ELSE 0 END) AS travel_sub_counts,
    MAX(CASE WHEN app_category = 'travel' THEN max_access_days ELSE 0 END) AS travel_access_days,
    SUM(CASE WHEN app_category = 'travel' THEN app_mbs ELSE 0 END) AS travel_app_mbs,
    -- Foodies
    SUM(CASE WHEN app_category = 'foodies' THEN interaction_count ELSE 0 END) AS foodies_flag_counts,
    SUM(CASE WHEN app_category = 'foodies' THEN sub_count ELSE 0 END) AS foodies_sub_counts,
    MAX(CASE WHEN app_category = 'foodies' THEN max_access_days ELSE 0 END) AS foodies_access_days,
    SUM(CASE WHEN app_category = 'foodies' THEN app_mbs ELSE 0 END) AS foodies_app_mbs,
    -- Electronics and Computers
    SUM(CASE WHEN app_category = 'electronics and computers' THEN interaction_count ELSE 0 END) AS Electronics_and_Computers_counts,
    (SELECT count(distinct subscription_id) FROM combined_data WHERE app_category = 'electronics and computers' AND Lower(app_name) NOT IN ('vodafone','orange','etisalat')) AS Electronics_and_Computers_sub_counts,
    MAX(CASE WHEN app_category = 'electronics and computers' THEN max_access_days ELSE 0 END) AS Electronics_and_Computers_access_days,
    -- Fashion
    SUM(CASE WHEN app_category = 'fashion' THEN interaction_count ELSE 0 END) AS fashion_flag_counts,
    SUM(CASE WHEN app_category = 'fashion' THEN sub_count ELSE 0 END) AS fashion_sub_counts,
    MAX(CASE WHEN app_category = 'fashion' THEN max_access_days ELSE 0 END) AS fashion_access_days,
    -- Mobile Store
    SUM(CASE WHEN app_category = 'mobile store' THEN interaction_count ELSE 0 END) AS Mobile_Store_flag_counts,
    SUM(CASE WHEN app_category = 'mobile store' THEN sub_count ELSE 0 END) AS Mobile_Store_sub_counts,
    MAX(CASE WHEN app_category = 'mobile store' THEN max_access_days ELSE 0 END) AS Mobile_Store_access_days,
    -- Grocery
    SUM(CASE WHEN app_category = 'grocery' THEN interaction_count ELSE 0 END) AS grocery_flag_counts,
    SUM(CASE WHEN app_category = 'grocery' THEN sub_count ELSE 0 END) AS grocery_sub_counts,
    MAX(CASE WHEN app_category = 'grocery' THEN max_access_days ELSE 0 END) AS grocery_access_days,
    -- Ride Booking
    SUM(CASE WHEN app_category = 'ride booking' THEN interaction_count ELSE 0 END) AS Ride_Booking_flag_counts,
    SUM(CASE WHEN app_category = 'ride booking' THEN sub_count ELSE 0 END) AS Ride_Booking_sub_counts,
    MAX(CASE WHEN app_category = 'ride booking' THEN max_access_days ELSE 0 END) AS Ride_Booking_access_days,
    SUM(CASE WHEN app_category = 'ride booking' THEN app_mbs ELSE 0 END) AS Ride_Booking_app_mbs,
    -- Online Learning
    SUM(CASE WHEN app_category = 'online learning' THEN interaction_count ELSE 0 END) AS Online_Learning_flag_counts,
    SUM(CASE WHEN app_category = 'online learning' THEN sub_count ELSE 0 END) AS Online_Learning_sub_counts,
    MAX(CASE WHEN app_category = 'online learning' THEN max_access_days ELSE 0 END) AS Online_Learning_access_days,
    SUM(CASE WHEN app_category = 'online learning' THEN app_mbs ELSE 0 END) AS Online_Learning_app_mbs,
    -- Medical
    SUM(CASE WHEN app_category = 'medical' THEN interaction_count ELSE 0 END) AS medical_flag_counts,
    SUM(CASE WHEN app_category = 'medical' THEN sub_count ELSE 0 END) AS medical_sub_counts,
    MAX(CASE WHEN app_category = 'medical' THEN max_access_days ELSE 0 END) AS medical_access_days,
    -- Lifestyle
    SUM(CASE WHEN app_category = 'lifestyle' THEN interaction_count ELSE 0 END) AS lifestyle_flag_counts,
    SUM(CASE WHEN app_category = 'lifestyle' THEN sub_count ELSE 0 END) AS lifestyle_sub_counts,
    MAX(CASE WHEN app_category = 'lifestyle' THEN max_access_days ELSE 0 END) AS lifestyle_access_days,
    -- Health (beauty)
    SUM(CASE WHEN app_category IN ('beauty') THEN interaction_count ELSE 0 END) AS Health_flag_counts,
    SUM(CASE WHEN app_category IN ('beauty') THEN sub_count ELSE 0 END) AS Health_sub_counts,
    MAX(CASE WHEN app_category IN ('beauty') THEN max_access_days ELSE 0 END) AS Health_access_days,
    -- Furniture
    SUM(CASE WHEN app_category IN ('furniture','furniture furnishing services') THEN interaction_count ELSE 0 END) AS furniture_furnishing_flag_counts,
    SUM(CASE WHEN app_category IN ('furniture','furniture furnishing services') THEN sub_count ELSE 0 END) AS furniture_furnishing_sub_counts,
    MAX(CASE WHEN app_category IN ('furniture','furniture furnishing services') THEN max_access_days ELSE 0 END) AS furniture_furnishing_access_days,
    -- Insurance
    SUM(CASE WHEN app_category = 'insurance' THEN interaction_count ELSE 0 END) AS insurance_flag_counts,
    SUM(CASE WHEN app_category = 'insurance' THEN sub_count ELSE 0 END) AS insurance_sub_counts,
    MAX(CASE WHEN app_category = 'insurance' THEN max_access_days ELSE 0 END) AS insurance_access_days,
    -- Education
    SUM(CASE WHEN app_category IN ('education','Education') THEN interaction_count ELSE 0 END) AS Education_flag_counts,
    SUM(CASE WHEN app_category IN ('education','Education') THEN sub_count ELSE 0 END) AS Education_sub_counts,
    MAX(CASE WHEN app_category IN ('education','Education') THEN max_access_days ELSE 0 END) AS Education_access_days,
    -- Entertainment
    SUM(CASE WHEN app_category = 'entertainment' THEN interaction_count ELSE 0 END) AS entertainment_flag_counts,
    SUM(CASE WHEN app_category = 'entertainment' THEN sub_count ELSE 0 END) AS entertainment_sub_counts,
    MAX(CASE WHEN app_category = 'entertainment' THEN max_access_days ELSE 0 END) AS entertainment_access_days,
    Cast(SUM(CASE WHEN app_category = 'entertainment' THEN app_mbs ELSE 0 END) AS DECIMAL(9,2)) AS entertainment_mbs
FROM category_counts;

--------------------------------------------------------------
here is the output:
sub_id_counts, total_interactions, rest of app_category_aggregations
 24237697	          361778733	         5262315	4313991	3	8790446.766461000	185833	170998	3	364398.466886000	206304	197093	3	194944.923881000	496160	433376	3	368888	347773	3	17	17	2	193816	193609	3	963640	722568	3	4887611.004352000	86476	86222	3	18874.312052000	163065	156831	3	235	235	2	406	403	3	21271	21270	3	9920	9914	3	37209	34266	3	189401	187708	3	853042.92
